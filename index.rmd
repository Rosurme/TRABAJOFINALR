---
title: "Bromelias de Costa Rica"
author: "Rosario Ureña Mena. A76600"
runtime: shiny
output: html_document
code-fold: true
---

Universidad de Costa Rica

Maestría Académica en Gestión Integral del Recurso Hídrico

Curso PF 0953, Programación en R, 2022-II

Profesor: Manuel Vargas del Valle

# TRABAJO FINAL

Cargar librerías
```{r}
#| label: cargar_librerias
#| context: setup
#| output: false
library(shiny)
library(rsconnect)
library(tidyverse)
library(ggplot2)
library(readr)
library(plotly)
library(DT)
library(dplyr)
library(sf)
library(s2)
                     
```

```{r}
rsconnect::setAccountInfo(name='1b6bd6-rosurme', token='DDAB307F46C05C33C788C385374211F9', secret='sPLJaQO5rP04NbXvQCQExgz1Q1XvPNIvDb0H7VA9')

```
Cargar datos de presencia de bromelias en Costa Rica, según Infraestructura Mundial de Información en Biodiversidad (GBIF)
```{r}
#| label: importacion_datos_bromelias
#| warning: false
#| message: false
#| code-fold: true

bromelias <- read_delim(file= "C:/Users/rosur/Documents/CURSO PROGRAMACION/TRABAJOFINALR/Bromelias.csv",
                       col_select = c(
      "species",
      "stateProvince",
      "locality",
      "eventDate",
      "decimalLongitude",
      "decimalLatitude"),
      locale = locale(encoding = "UTF-8"))

 
bromelias <- bromelias |>
   mutate(eventDate= as.Date(eventDate, format = "%d/%m/%Y"))
 
bromelias <- bromelias |>
  drop_na()

```
## Resultados
1. Una tabla que muestre los registros de presencia. Incluya, al menos, las columnas: especie (species), provincia (stateProvince), localidad (locality), provincia o estado (stateProvince), fecha (eventDate).
-Los encabezados de las columnas en la tabla deben estar correctamente escritos (ej. con tildes), pero no deben alterarse los nombres de las columnas del conjunto de datos. Sugerencia: utilice el argumento colnames de la función DT::datatable().
-Los controles de la tabla deben estar en español.
```{r}
#| label: servidor 
tabla_bromelias <- bromelias |> 
  select("species",
      "stateProvince",
      "locality",
      "eventDate",
      "decimalLongitude",
      "decimalLatitude") |>
  datatable(colnames = c("Especie"="species",
                         "Provincia" ="stateProvince",
                         "Localidad" = "locality",
                         "Fecha_avistamiento" ="eventDate",
                         "Coord_Longitud" ="decimalLongitude",
                         "Coord_Latitud" ="decimalLatitude"), 
            options = list(pageLength = 5, language = list(url = '//cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))

```
Barra lateral, Lista de especies
```{r}
#| label: interfaz_usuario_barra_lateral 
#| panel: sidebar 

lista_especies <- unique(bromelias$species)
lista_especies <- sort(lista_especies)
lista_especies <- c("Todas", lista_especies) 

ui <- fluidPage(
  sidebarLayout(
    sidebarPanel(
      selectInput(
        inputId = "species",
        label = "Especie",
        choices = lista_especies,
        selected = "Todas")),
    mainPanel(dataTableOutput(outputId = "Tabla"))))

server <- function(input, output, session) {
  output$Tabla <- renderDataTable({tabla_bromelias})}

shinyApp(ui, server)

```
